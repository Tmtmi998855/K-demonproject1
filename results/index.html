<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>K-Demon MBTI 결과 페이지</title>
  <meta name="description" content="테스트 결과와 16가지 Korean Demon MBTI 갤러리를 한 페이지에서 확인합니다.">
  <style>
    :root{--bg:#0b1020;--panel:#121933;--accent:#6ee7ff;--accent2:#a78bfa;--text:#e8eefc;--muted:#a8b0c9;--radius:16px}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b1020,#0e1430);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Arial}
    .wrap{max-width:1000px;margin:24px auto;padding:20px}
    .card{background:radial-gradient(1200px 600px at 100% -20%,rgba(167,139,250,.08),transparent 60%),radial-gradient(1200px 600px at 0% 120%,rgba(110,231,255,.08),transparent 60%),var(--panel);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:0 10px 30px rgba(0,0,0,.35);overflow:hidden}
    header{padding:24px 20px;border-bottom:1px solid rgba(255,255,255,.06)}
    h1{margin:0 0 6px;font-size:clamp(20px,3vw,28px)}
    .muted{color:var(--muted)}
    .hero{display:grid;grid-template-columns:180px 1fr;gap:18px;align-items:center;padding:20px}
    .hero img{width:100%;height:180px;object-fit:contain;background:rgba(255,255,255,.03);border-radius:14px;border:1px solid rgba(255,255,255,.08)}
    .type{font-size:36px;font-weight:900;letter-spacing:2px}
    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
    .btn{border:none;cursor:pointer;font-weight:700;letter-spacing:.2px;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#0b1020;padding:10px 14px;border-radius:12px;box-shadow:0 6px 18px rgba(110,231,255,.2)}
    .btn.secondary{background:rgba(255,255,255,.1);color:var(--text);box-shadow:none}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:14px;padding:0 20px 20px}
    .card2{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:14px;overflow:hidden}
    .card2 img{width:100%;height:150px;object-fit:contain;background:rgba(255,255,255,.02)}
    .cap{display:flex;align-items:center;justify-content:space-between;padding:10px 12px}
    .tag{font-weight:800}
    .current{outline:2px solid var(--accent)}
    footer{padding:14px 20px 22px;color:var(--muted);font-size:13px;border-top:1px solid rgba(255,255,255,.06)}
    a{color:var(--accent);text-decoration:none}

    /* === 모바일 최적화(반응형) === */
    @media (max-width: 640px) {
      .wrap { padding: 12px; }
      .hero { grid-template-columns: 1fr; }                 /* 2열 → 1열 스택 */
      .hero img { height: auto; aspect-ratio: 3 / 4; }      /* 비율 유지 */
      .grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1>K-Demon MBTI 결과</h1>
        <p class="muted">당신의 유형과 16가지 데몬을 한 페이지에서 확인하세요. (오락용 간이 테스트)</p>
      </header>

      <section class="hero" id="hero" aria-live="polite">
        <img id="heroImg" src="" alt="당신의 MBTI 데몬 이미지">
        <div>
          <div class="muted">당신의 결과</div>
          <div class="type" id="heroType">—</div>
          <div id="heroDesc" class="muted">선택한 유형에 대한 간단 설명을 여기에 넣을 수 있습니다.</div>
          <div class="btns">
            <a class="btn" href="../index.html">테스트 다시 하기</a>
            <button class="btn secondary" id="copyBtn" type="button">결과 링크 복사</button>
          </div>
        </div>
      </section>

      <section>
        <div class="grid" id="grid" aria-label="16가지 데몬 갤러리"></div>
      </section>

      <footer>© <span id="year"></span> K-Demon MBTI Gallery</footer>
    </div>
  </div>

<script>
  const TYPES = ['INTJ','INTP','ENTJ','ENTP','INFJ','INFP','ENFJ','ENFP','ISTJ','ISFJ','ESTJ','ESFJ','ISTP','ISFP','ESTP','ESFP'];
  const DESCS = {
    ENFP:'발산형 아이디어와 에너지. 호기심/사람 중심.',
    INFJ:'통찰/가치 지향. 깊이 있는 관계와 의미.',
    INTJ:'전략가. 장기계획과 시스템 최적화.',
    INTP:'탐구/분석. 원리/모형을 중시.',
    ENFJ:'조화/리더십. 타인 성장 촉진.',
    ENTJ:'실행/조직화. 목표달성 드라이브.',
    ENTP:'아이디어/도전. 논쟁적 탐구자.',
    INFP:'가치/진정성. 이상과 현실 가교.',
    ISFP:'감성/미감. 조용한 실천자.',
    ISTP:'문제 해결/도구 감각.',
    ISFJ:'헌신/책임. 안정적 돌봄.',
    ISTJ:'규범/체계. 신뢰할 수 있는 실행.',
    ESFJ:'관계/서비스. 팀 기여 극대화.',
    ESTJ:'조직/관리. 절차 중심 실행.',
    ESFP:'순간의 즐거움/경험. 분위기 메이커.',
    ESTP:'행동/임기응변. 현장 해결사.'
  };

  // 실제 업로드 파일명 매핑
  const IMG_MAP = {
    ENTP:'../assets/demons/1-ENTP.png',
    ENTJ:'../assets/demons/10-ENTJ.png',
    INFJ:'../assets/demons/11-INFJ.png',
    INFP:'../assets/demons/12-INFP.png',
    ENFP:'../assets/demons/13-ENFP.jpg',
    ESFJ:'../assets/demons/14-ESFJ.png',
    INTP:'../assets/demons/15-INTP.png',
    ISFP:'../assets/demons/16-ISFP.png',
    ISFJ:'../assets/demons/2-ISFJ.png',
    ESTJ:'../assets/demons/3-ESTJ.png',
    ISTP:'../assets/demons/4-ISTP.png',
    INTJ:'../assets/demons/5-INTJ.png',
    ISTJ:'../assets/demons/6-ISTJ.jpg',
    ESTP:'../assets/demons/7-ESTP.png',
    ESFP:'../assets/demons/8-ESFP.png',
    ENFJ:'../assets/demons/9-ENFJ.png'
  };
  function getImgSrc(type){ return IMG_MAP[type] ?? '../assets/demons/_placeholder.png'; }

  const params = new URLSearchParams(location.search);
  const raw = (params.get('type')||'').toUpperCase();
  let current = TYPES.includes(raw) ? raw : 'ENFP';

  const yearEl = document.getElementById('year');
  const heroTypeEl = document.getElementById('heroType');
  const heroImgEl = document.getElementById('heroImg');
  const heroDescEl = document.getElementById('heroDesc');
  const gridEl = document.getElementById('grid');
  yearEl.textContent = new Date().getFullYear();

  function renderHero(){
    heroTypeEl.textContent = current;
    heroImgEl.src = getImgSrc(current);
    heroImgEl.loading = 'eager';     // ↑ 첫 화면 이미지 우선 로딩
    heroImgEl.decoding = 'async';    // ↑ 비동기 디코딩
    heroImgEl.onerror = () => { heroImgEl.src = '../assets/demons/_placeholder.png'; };
    heroDescEl.textContent = DESCS[current] || '유형 설명을 준비 중입니다.';
    document.title = `K-Demon MBTI 결과 – ${current}`;
    const url = new URL(location.href); url.searchParams.set('type', current); history.replaceState(null,'',url);
  }

  function renderGrid(){
    gridEl.innerHTML = '';
    TYPES.forEach(t => {
      const card = document.createElement('div'); card.className = 'card2'+(t===current?' current':'');
      const img = document.createElement('img');
      img.src = getImgSrc(t);
      img.alt = `${t} 데몬 이미지`;
      img.loading = 'lazy';         // ← 아래쪽 이미지는 지연 로딩
      img.decoding = 'async';
      img.onerror = () => { img.src = '../assets/demons/_placeholder.png'; };
      const cap = document.createElement('div'); cap.className='cap';
      const tag = document.createElement('span'); tag.className='tag'; tag.textContent=t;
      const btn = document.createElement('button'); btn.textContent='보기'; btn.className='btn secondary';
      btn.addEventListener('click', () => { current=t; renderHero(); renderGrid(); window.scrollTo({top:0,behavior:'smooth'}); });
      cap.appendChild(tag); cap.appendChild(btn);
      card.appendChild(img); card.appendChild(cap);
      gridEl.appendChild(card);
    });
  }

  document.getElementById('copyBtn').addEventListener('click', async () => {
    try { await navigator.clipboard.writeText(location.href); alert('결과 링크가 복사되었습니다.'); }
    catch { prompt('복사할 수 없습니다. 아래 링크를 직접 복사하세요.', location.href); }
  });

  renderHero(); renderGrid();
</script>
</body>
</html>
